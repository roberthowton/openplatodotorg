---
// Source: https://github.com/raffazizzi/astro-tei/blob/bfb46d2dce80abf31cab174aae78b0cc401701b9/packages/core/src/Tei.astro
import TeiStyle from "../styles/tei-style.astro";
import { type ProcessedTei } from "../utils/processTei.ts";
export interface Props {
  useBehaviors?: boolean;
  teiData: ProcessedTei;
  rootId?: string;
  language?: string;
  hideLineNumbers?: boolean;
}

let { teiData, useBehaviors = true, rootId, language, hideLineNumbers = false } = Astro.props;

// Expand self-closing elements
const tei = teiData.serialized.replace(
  /<([^\s\/]+)([^>]*?)\/>/gm,
  "<$1$2></$1>",
);
---

<script>
  import { createTeiCustomElement } from "./TeiCustomElement";

  const TeiContainer = createTeiCustomElement();
  customElements.define("tei-container", TeiContainer);
</script>

<tei-container
  set:html={tei}
  data-root-id={rootId}
  data-language={language}
  data-usebehaviors={useBehaviors.toString()}
  data-elements={teiData.elements.toString()}
  data-hide-line-numbers={hideLineNumbers.toString()}
  style="display: none;"
/>

<TeiStyle />
